<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://wqyuu.github.io/blog</id>
    <title>Wqyuu</title>
    <updated>2020-02-18T10:08:29.777Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://wqyuu.github.io/blog"/>
    <link rel="self" href="https://wqyuu.github.io/blog/atom.xml"/>
    <subtitle>ç§‰å¿ è´ä¹‹å¿—,å®ˆè°¦é€€ä¹‹èŠ‚</subtitle>
    <logo>https://wqyuu.github.io/blog/images/avatar.png</logo>
    <icon>https://wqyuu.github.io/blog/favicon.ico</icon>
    <rights>All rights reserved 2020, Wqyuu</rights>
    <entry>
        <title type="html"><![CDATA[Ubuntu 16.04æ­å»ºJAVAç¯å¢ƒ]]></title>
        <id>https://wqyuu.github.io/blog/post/ubuntu-1604-da-jian-java-huan-jing</id>
        <link href="https://wqyuu.github.io/blog/post/ubuntu-1604-da-jian-java-huan-jing">
        </link>
        <updated>2019-05-13T12:59:33.000Z</updated>
        <content type="html"><![CDATA[<p>æ­å»ºç¯å¢ƒï¼šUbuntu 16.04 Ã—64<br>
JDK :jdk-8u171-linux-x64.tar.gz</p>
<ol>
<li>
<p>é¦–å…ˆä¸‹è½½linuxå¯¹åº”çš„å®‰è£…åŒ…<br>
ä¸‹è½½åœ°å€ï¼š<a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html">http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html</a><br>
ä¸‹è½½å®Œæˆåï¼ŒLinuxé»˜è®¤ä¸‹è½½ä½ç½®åœ¨å½“å‰ç›®å½•ä¸‹çš„Downloadæˆ–ä¸‹è½½æ–‡ä»¶å¤¹ä¸‹ï¼Œé€šè¿‡å‘½ä»¤cd ~/Downloadsæˆ–cd  ~/ä¸‹è½½å³å¯æŸ¥çœ‹åˆ°å¯¹åº”çš„æ–‡ä»¶ã€‚</p>
</li>
<li>
<p>è§£å‹å®‰è£…åŒ…jdk-8u171-linux-x64.tar.gz<br>
tar -zxvf jdk-8u171-linux-x64.tar.gz</p>
</li>
<li>
<p>å°†è§£å‹åçš„æ–‡ä»¶å¤¹ç§»åˆ°/usr/libç›®å½•ä¸‹<br>
åˆ‡æ¢åˆ° /usr/libç›®å½•ä¸‹<br>
cd  /usr/lib<br>
å¹¶æ–°å»ºjdkç›®å½•<br>
sudo mkdir jdk</p>
</li>
<li>
<p>å°†è§£å‹çš„jdkæ–‡ä»¶å¤åˆ¶åˆ°æ–°å»ºçš„/usr/lib/jdkç›®å½•ä¸‹æ¥<br>
sudo mv ~/jdk1.8.0_171/usr/lib/jdk<br>
æ‰§è¡Œå‘½ä»¤åå¯åˆ° usr/lib/jdk ç›®å½•ä¸‹æŸ¥çœ‹æ˜¯å¦å¤åˆ¶æˆåŠŸ</p>
</li>
<li>
<p>é…ç½®javaç¯å¢ƒå˜é‡<br>
è¿™é‡Œæ˜¯å°†ç¯å¢ƒå˜é‡é…ç½®åœ¨etc/profileï¼Œå³ä¸ºæ‰€æœ‰ç”¨æˆ·é…ç½®JDKç¯å¢ƒã€‚<br>
ä½¿ç”¨å‘½ä»¤æ‰“å¼€/etc/profileæ–‡ä»¶<br>
sudo vi /etc/profile<br>
åœ¨æœ«å°¾æ·»åŠ ä»¥ä¸‹å‡ è¡Œæ–‡å­—ï¼š</p>
<pre><code class="language-config">#set java env
export JAVA_HOME=/usr/lib/jdk/jdk1.8.0_171
export JRE_HOME=${JAVA_HOME}/jre    
export CLASSPATH=.:${JAVA_HOME}/lib:${JRE_HOME}/lib    
export PATH=${JAVA_HOME}/bin:$PATH 
</code></pre>
</li>
<li>
<p>æ‰§è¡Œå‘½ä»¤ä½¿ä¿®æ”¹ç«‹å³ç”Ÿæ•ˆ`<br>
source /etc/profile</p>
</li>
<li>
<p>é…ç½®è½¯è¿æ¥<br>
è½¯è¿æ¥ç›¸å½“äºwindowsç³»ç»Ÿä¸­çš„å¿«æ·é”®ï¼Œéƒ¨åˆ†è½¯ä»¶å¯èƒ½ä¼šä»/usr/binç›®å½•ä¸‹æŸ¥æ‰¾Javaï¼Œå› æ­¤æ·»åŠ è¯¥è½¯è¿æ¥é˜²æ­¢å…¶ä»–è½¯ä»¶æŸ¥æ‰¾ä¸åˆ°çš„æƒ…å†µã€‚</p>
</li>
</ol>
<pre><code>sudo update-alternatives --install /usr/bin/java  java  /usr/lib/jdk/jdk1.8.0_171/bin/java 300   
sudo update-alternatives --install /usr/bin/javac  javac  /usr/lib/jdk/jdk1.8.0_171/bin/javac 300 
æ‰©å±•ï¼šåœ¨Ubuntuä¸­é€šè¿‡update-alternativesåˆ‡æ¢jdkç‰ˆæœ¬
</code></pre>
<ol start="8">
<li>æµ‹è¯•å®‰è£…æ˜¯å¦æˆåŠŸ<br>
åœ¨ç»ˆç«¯è¾“å…¥ï¼Œå‡ºç°ç‰ˆæœ¬å·åˆ™è¡¨ç¤ºå®‰è£…æˆåŠŸ<br>
java -version</li>
</ol>
<figure data-type="image" tabindex="1"><img src="https://wqyuu.github.io/blog/post-images/1582020044962.jpg" alt="" loading="lazy"></figure>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Oracleæ•°æ®åº“æ‰¹é‡æ“ä½œ]]></title>
        <id>https://wqyuu.github.io/blog/post/oracle-shu-ju-ku-pi-liang-cao-zuo</id>
        <link href="https://wqyuu.github.io/blog/post/oracle-shu-ju-ku-pi-liang-cao-zuo">
        </link>
        <updated>2019-05-12T11:57:24.000Z</updated>
        <content type="html"><![CDATA[<h2 id="ä¸€æ¬¡å¯¹sqlä¿®æ”¹ä¼˜åŒ–æ“ä½œé€Ÿåº¦çš„è®°å½•">ä¸€æ¬¡å¯¹SQLä¿®æ”¹ï¼Œä¼˜åŒ–æ“ä½œé€Ÿåº¦çš„è®°å½•</h2>
<p>æˆ‘éœ€è¦æŠŠedit_stuè¡¨æ•°æ®æŸ¥å‡ºæ¥æ‰¹é‡æ’å…¥åˆ°student_mä¸­ï¼Œ<br>
ç”±äºSQLæ‰¹é‡æ“ä½œæ‰§è¡Œé€Ÿåº¦ç‰¹åˆ«æ…¢ï¼Œå°è¯•æ›´æ¢SQLè¯­å¥è§£å†³é€Ÿåº¦é—®é¢˜<br>
æ ¹æ®éœ€è¦æˆ‘æœ‰ä¸¤ä¸ªæ–¹æ³•åšè¿™ä¸ªæ‰¹é‡æ“ä½œï¼š</p>
<ul>
<li>æ–¹æ³•1ï¼š</li>
</ul>
<pre><code class="language-xml">	&lt;insert id=&quot;insert1&quot; parameterType=&quot;java.util.HashMap&quot;&gt;
		 begin
        &lt;foreach collection=&quot;list&quot; item=&quot;item&quot; index=&quot;index&quot; separator=&quot;;&quot;&gt;
        	 insert into student_m ( VERSION_ID, SYS_ID)
        values
            ( #{item.versionId,jdbcType=VARCHAR},
			#{item.sysId,jdbcType=VARCHAR}
        &lt;/foreach&gt;
        ;end;
    &lt;/insert&gt;
</code></pre>
<ul>
<li>æ–¹æ³•2</li>
</ul>
<pre><code class="language-xml"> &lt;!--æ‹·è´æ•°æ®åˆ°æŸ¥è¯¢è¡¨--&gt;
    &lt;insert id=&quot;insertCurrentBySelect&quot;  parameterType=&quot;java.util.HashMap&quot;&gt;
    	INSERT INTO  student_m ( VERSION_ID, SYS_ID)
	    SELECT   VERSION_ID, SYS_ID
      	FROM  edit_stu
	    WHERE VERSION_ID=#{versionId,jdbcType=VARCHAR}
    &lt;/insert&gt;
</code></pre>
<h2 id="ä¸¤ä¸ªæ–¹æ³•æ“ä½œé€Ÿåº¦å¯¹æ¯”">ä¸¤ä¸ªæ–¹æ³•æ“ä½œé€Ÿåº¦å¯¹æ¯”ï¼š</h2>
<table>
<thead>
<tr>
<th>æ•°æ®é‡</th>
<th>æ–¹æ³•1</th>
<th>æ–¹æ³•2</th>
</tr>
</thead>
<tbody>
<tr>
<td>50</td>
<td>2s</td>
<td>2.5s</td>
</tr>
<tr>
<td>500</td>
<td>2.5s</td>
<td>5.2s</td>
</tr>
</tbody>
</table>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[MyBatiså¯¹äºJavaå¯¹è±¡é‡Œçš„æšä¸¾ç±»å‹å¤„ç†]]></title>
        <id>https://wqyuu.github.io/blog/post/mybatis-dui-yu-java-dui-xiang-li-de-mei-ju-lei-xing-chu-li</id>
        <link href="https://wqyuu.github.io/blog/post/mybatis-dui-yu-java-dui-xiang-li-de-mei-ju-lei-xing-chu-li">
        </link>
        <updated>2019-05-10T12:54:48.000Z</updated>
        <content type="html"><![CDATA[<hr>
<p>mybatisé‡Œæ€ä¹ˆå¤„ç†æšä¸¾ç±»å‹å±æ€§çš„å¢åˆ æ”¹æŸ¥å‘¢ï¼Ÿ</p>
<p>è¦æ±‚ï¼š</p>
<p>æ’å…¥çš„æ—¶å€™ï¼Œä¼šç”¨æšä¸¾çš„å®šä¹‰æ’å…¥æ•°æ®åº“ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨æ•°æ®åº“ä¸­çœ‹åˆ°çš„æ˜¯æ•°å­—æˆ–è€…å…¶ä»–ä¸œè¥¿ï¼›</p>
<p>æŸ¥è¯¢çš„æ—¶å€™ï¼Œæ•°æ®åº“çš„å€¼å¯ä»¥è‡ªåŠ¨è½¬æ¢ä¸ºæˆ‘ä»¬å¯¹åº”çš„æšä¸¾å€¼ã€‚</p>
<p>ä¸¾ä¾‹ï¼Œæˆ‘æœ‰ä¸€ä¸ªè¿™æ ·çš„æšä¸¾ç±»å‹ï¼š</p>
<pre><code class="language-java">package cn.com.shuyangyang.domain;  
  
public enum UserStatus {  
  
    /** æ— æ•ˆ*/  
    DISABLED(0),  
    /** æœ‰æ•ˆ */  
    AVAILABLE(1);  
      
    private int status;  
      
    UserStatus(int status){  
        this.status = status;  
    }  
  
    public int getStatus() {  
        return status;  
    }  
      
}  
</code></pre>
<p>æˆ‘ä»¬æ’å…¥æ•°æ®åº“ä¸­ï¼Œæ•°æ®åº“åº”è¯¥ä¸ºæˆ‘ä»¬ä¿å­˜0æˆ–è€…1</p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨mybatisè‡ªå¸¦çš„æšä¸¾ç±»å‹EnumOrdinalTypeHandler</p>
<p>ä¸¾ä¾‹å¦‚ä¸‹ï¼š</p>
<pre><code class="language-xml">&lt;insert id=&quot;addUser&quot; parameterType=&quot;User&quot;&gt;  
    INSERT INTO t_user(USER_ID,USER_NAME,LOGIN_NAME,  
    LOGIN_PASSWORD,USER_STATUS,CREATE_TIME,UPDATE_TIME)  
    VALUES(  
        #{user_id},  
        #{user_name},  
        #{login_name},  
        #{login_password},  
        #{user_status, typeHandler=org.apache.ibatis.type.EnumOrdinalTypeHandler},  
        #{create_time},  
        #{update_time}  
    )  
&lt;/insert&gt;
</code></pre>
<p>æˆ‘ä»¬çš„UserStatusæ’å…¥çš„æ—¶å€™æ˜¯UserStatus.AVAILABLE</p>
<p>æ‰§è¡Œå®Œæ¯•åï¼Œçœ‹ç»“æœï¼š</p>
<figure data-type="image" tabindex="1"><img src="https://img-blog.csdnimg.cn/20190506101619818.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM3MzM4NzYx,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"></figure>
<p>çœ‹ï¼Œæ˜¯ä¸æ˜¯ç»“æœæ˜¯æˆ‘ä»¬æœŸæœ›çš„é‚£æ ·ã€‚</p>
<p>ä½†æ˜¯é—®é¢˜æ¥äº†ï¼Ÿ</p>
<p>æˆ‘ä»¬æŸ¥è¯¢çš„æ—¶å€™æŠ¥é”™äº†ï¼šError querying database.  Cause: java.lang.IllegalArgumentException: No enum constant cn.com.shuyangyang.mybatis.UserStatus.1</p>
<p>æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰è¿™æ ·çš„ä¸€ä¸ªEnumStatusHandlerï¼š</p>
<pre><code class="language-java">package cn.com.shuyangyang.mybatis;  
  
import java.sql.CallableStatement;  
import java.sql.PreparedStatement;  
import java.sql.ResultSet;  
import java.sql.SQLException;  
  
import org.apache.ibatis.type.BaseTypeHandler;  
import org.apache.ibatis.type.JdbcType;  
  
/** 
 * Mybatisè‡ªå®šä¹‰è½¬æ¢ç±»å‹ 
 * @author ShuYangYang 
 * E-Mail:shuyangyang@aliyun.com 
 * http://www.shuyangyang.com.cn 
 * Date:2015å¹´1æœˆ26æ—¥ä¸‹åˆ10:12:54 
 * 
 */  
public class EnumStatusHandler extends BaseTypeHandler&lt;UserStatus&gt; {  
      
    private Class&lt;UserStatus&gt; type;  
       
    private final UserStatus[] enums;  
   
    /** 
     * è®¾ç½®é…ç½®æ–‡ä»¶è®¾ç½®çš„è½¬æ¢ç±»ä»¥åŠæšä¸¾ç±»å†…å®¹ï¼Œä¾›å…¶ä»–æ–¹æ³•æ›´ä¾¿æ·é«˜æ•ˆçš„å®ç° 
     * @param type é…ç½®æ–‡ä»¶ä¸­è®¾ç½®çš„è½¬æ¢ç±» 
     */  
    public EnumStatusHandler(Class&lt;UserStatus&gt; type) {  
        if (type == null)  
            throw new IllegalArgumentException(&quot;Type argument cannot be null&quot;);  
        this.type = type;  
        this.enums = type.getEnumConstants();  
        if (this.enums == null)  
            throw new IllegalArgumentException(type.getSimpleName()  
                    + &quot; does not represent an enum type.&quot;);  
    }  
  
    @Override  
    public void setNonNullParameter(PreparedStatement ps, int i,  
            UserStatus parameter, JdbcType jdbcType) throws SQLException {  
        // baseTypeHandlerå·²ç»å¸®æˆ‘ä»¬åšäº†parameterçš„nullåˆ¤æ–­  
        ps.setInt(i, parameter.getStatus());  
          
    }  
  
    @Override  
    public UserStatus getNullableResult(ResultSet rs, String columnName)  
            throws SQLException {  
        // æ ¹æ®æ•°æ®åº“å­˜å‚¨ç±»å‹å†³å®šè·å–ç±»å‹ï¼Œæœ¬ä¾‹å­ä¸­æ•°æ®åº“ä¸­å­˜æ”¾INTç±»å‹  
        int i = rs.getInt(columnName);  
           
        if (rs.wasNull()) {  
            return null;  
        } else {  
            // æ ¹æ®æ•°æ®åº“ä¸­çš„codeå€¼ï¼Œå®šä½EnumStatuså­ç±»  
            return locateEnumStatus(i);  
        }  
    }  
  
    @Override  
    public UserStatus getNullableResult(ResultSet rs, int columnIndex)  
            throws SQLException {  
        // æ ¹æ®æ•°æ®åº“å­˜å‚¨ç±»å‹å†³å®šè·å–ç±»å‹ï¼Œæœ¬ä¾‹å­ä¸­æ•°æ®åº“ä¸­å­˜æ”¾INTç±»å‹  
        int i = rs.getInt(columnIndex);  
        if (rs.wasNull()) {  
            return null;  
        } else {  
            // æ ¹æ®æ•°æ®åº“ä¸­çš„codeå€¼ï¼Œå®šä½EnumStatuså­ç±»  
            return locateEnumStatus(i);  
        }  
    }  
  
    @Override  
    public UserStatus getNullableResult(CallableStatement cs, int columnIndex)  
            throws SQLException {  
        // æ ¹æ®æ•°æ®åº“å­˜å‚¨ç±»å‹å†³å®šè·å–ç±»å‹ï¼Œæœ¬ä¾‹å­ä¸­æ•°æ®åº“ä¸­å­˜æ”¾INTç±»å‹  
        int i = cs.getInt(columnIndex);  
        if (cs.wasNull()) {  
            return null;  
        } else {  
            // æ ¹æ®æ•°æ®åº“ä¸­çš„codeå€¼ï¼Œå®šä½EnumStatuså­ç±»  
            return locateEnumStatus(i);  
        }  
    }  
      
    /** 
     * æšä¸¾ç±»å‹è½¬æ¢ï¼Œç”±äºæ„é€ å‡½æ•°è·å–äº†æšä¸¾çš„å­ç±»enumsï¼Œè®©éå†æ›´åŠ é«˜æ•ˆå¿«æ· 
     * @param code æ•°æ®åº“ä¸­å­˜å‚¨çš„è‡ªå®šä¹‰codeå±æ€§ 
     * @return codeå¯¹åº”çš„æšä¸¾ç±» 
     */  
    private UserStatus locateEnumStatus(int code) {  
        for(UserStatus status : enums) {  
            if(status.getStatus()==(Integer.valueOf(code))) {  
                return status;  
            }  
        }  
        throw new IllegalArgumentException(&quot;æœªçŸ¥çš„æšä¸¾ç±»å‹ï¼š&quot; + code + &quot;,è¯·æ ¸å¯¹&quot; + type.getSimpleName());  
    }  
  
}  
</code></pre>
<p>mapper.xmlé‡Œè¿™æ ·é…ç½®ï¼š</p>
<p>XML/HTML Codeå¤åˆ¶å†…å®¹åˆ°å‰ªè´´æ¿<br>
<resultMap type="User" id="userResult"><br>
â€¦â€¦çœç•¥å…¶ä»–å±æ€§é…ç½®<br>
<result column="USER_STATUS" property="user_status" typeHandler="cn.com.shuyangyang.mybatis.EnumStatusHandler"/><br>
â€¦â€¦çœç•¥å…¶ä»–å±æ€§é…ç½®<br>
</resultMap><br>
ç°åœ¨æ¥çœ‹çœ‹ç»“æœï¼š</p>
<blockquote>
<p>[User [user_id=782cba19-559f-41c3-a1b0-25fcac4cf118, user_name=ç³»ç»Ÿç®¡ç†å‘˜, login_name=admin, login_password=admin,user_status=AVAILABLE, create_time=Mon Jan 26 21:17:09 CST 2015, update_time=Mon Jan 26 21:17:09 CST 2015]]</p>
</blockquote>
<p>å®Œç¾ç»“æœã€‚</p>
<p>è½¬è½½è‡ªï¼š http://www.shuyangyang.com.cn/jishuliangongfang/Javabiancheng/2015-01-26/229.html</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[VirtualBox+ubantu16.04è”ç½‘]]></title>
        <id>https://wqyuu.github.io/blog/post/virtualboxubantu1604-lian-wang</id>
        <link href="https://wqyuu.github.io/blog/post/virtualboxubantu1604-lian-wang">
        </link>
        <updated>2019-05-06T07:51:45.000Z</updated>
        <content type="html"><![CDATA[<h2 id="virtualboxubantu1604è”ç½‘">VirtualBox+ubantu16.04è”ç½‘</h2>
<p>ä¸€ã€å®‰è£…virtualboxåä¼šè‡ªåŠ¨å®‰è£…ä¸€ä¸ªè™šæ‹Ÿç½‘å¡ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œåå­—ä¼šæ˜¯VirtualBox Host-Only Network<br>
<img src="https://img-blog.csdnimg.cn/20190506174943352.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM3MzM4NzYx,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br>
äºŒã€å³é”®å·²è¿æ¥ä¸Šçš„ç½‘ç»œï¼ˆå¯èƒ½æ˜¯ä»¥å¤ªç½‘ä¹Ÿå¯ä»¥æ˜¯wifiï¼‰-&gt; å±æ€§ -&gt;å…±äº«<br>
<img src="https://img-blog.csdnimg.cn/2019050617500488.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM3MzM4NzYx,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br>
ä¸‰ã€ä¿®æ”¹è¿™ä¸ªè™šæ‹Ÿç½‘å¡çš„ipv4è®¾ç½®ï¼ˆå³é”®è™šæ‹Ÿç½‘å¡-&gt;å±æ€§-&gt;ipv4åè®®-&gt;å±æ€§ï¼‰<br>
<img src="https://img-blog.csdnimg.cn/20190506175016812.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM3MzM4NzYx,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br>
å››ã€ä¿®æ”¹virtualboxä¸Šçš„è™šæ‹Ÿæœºçš„ç½‘å¡è®¾ç½®ä¸ºHost-Only ã€‚è¿™é‡Œæ³¨æ„ï¼ä¸€å®šæŒ‰ç…§å›¾ç¤ºè®¾ç½®ï¼Œå°±ç®—ä½¿ç”¨wifiï¼Œä¹Ÿè¦å¡«æ¥å…¥ç½‘çº¿<br>
<img src="https://img-blog.csdnimg.cn/20190506175031631.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM3MzM4NzYx,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br>
äº”ã€ç„¶åé…ç½®è™šæ‹Ÿæœºçš„ç½‘ç»œé…ç½®æ–‡ä»¶</p>
<ol>
<li>
<p>è¾“å…¥ifconfigå‘½ä»¤æŸ¥çœ‹ç½‘å¡ä¿¡æ¯ï¼Œä¸‹å›¾çº¢åœˆå¤„å°±æ˜¯ç½‘å¡åç§°ã€‚<br>
<img src="https://img-blog.csdnimg.cn/20190506175244478.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM3MzM4NzYx,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"></p>
</li>
<li>
<p>é…ç½®ç½‘å¡æ–‡ä»¶<br>
æ³¨æ„ï¼šä¸åŒçš„linuxç³»ç»Ÿï¼Œç½‘å¡é…ç½®æ–‡ä»¶æ˜¯ä¸åŒçš„ï¼Œè¿™é‡Œubuntuçš„ç½‘å¡é…ç½®æ–‡ä»¶æ˜¯/etc/network/interfaces<br>
è¾“å…¥ä¸‹é¢å‘½ä»¤è¿›è¡Œç¼–è¾‘ç½‘å¡æ–‡ä»¶<br>
sudo vi /etc/network/interfaces<br>
é»˜è®¤çš„æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>auto lo iface lo inet loopback</p>
</blockquote>
<p>ç°åœ¨ä¿®æ”¹é…ç½®æ–‡ä»¶ã€‚ä¿®æ”¹æ–¹å¼æœ‰ä¸¤ç§<br>
æ–¹å¼ä¸€ï¼šé™æ€ip<br>
ä¿®æ”¹å†…å®¹å¦‚ä¸‹ï¼šä¸‹é¢çš„enp0s3éœ€è¦æ”¹æˆè‡ªå·±çš„ç½‘å¡åç§°ï¼Œå°±æ˜¯ä¸Šé¢ç¬¬ä¸€æ­¥çš„çº¢åœˆä¿¡æ¯ã€‚ipåœ°å€ï¼Œæ©ç ç½‘å…³è‡ªå·±åˆç†é…ç½®å°±è¡Œäº†ã€‚è®°å¾—wq!ä¿å­˜é€€å‡ºã€‚</p>
<blockquote>
<p>auto enp0s3<br>
iface enp0s3 inet static<br>
address 192.168.56.3<br>
netmask 255.255.255.0<br>
gateway  192.168.56.1<br>
dns-nameservers 223.5.5.5</p>
</blockquote>
<p>æ–¹å¼äºŒï¼šåŠ¨æ€è·å–ipé…ç½®</p>
<blockquote>
<p>auto enp0s3 	<br>
iface enp0s3 inet dhcp</p>
</blockquote>
<p>æ³¨æ„ä¸Šé¢çš„ç½‘å¡å†™æˆè‡ªå·±çš„ç½‘å¡åç§°ã€‚è®°å¾—wq!ä¿å­˜é€€å‡ºã€‚</p>
</li>
<li>
<p>ä¿®æ”¹DNSæœåŠ¡å™¨åœ°å€</p>
<p>é€šè¿‡/etc/network/interfacesï¼Œåœ¨å®ƒçš„æœ€åå¢åŠ ä¸€å¥ä¸‹é¢çš„å†…å®¹ï¼šä¸‹é¢çš„223.5.5.5æ˜¯é˜¿é‡Œçš„dnsåœ°å€ï¼Œå¯ä»¥è‡ªå·±é€‰æ‹©é€‚åˆçš„dnsåœ°å€ã€‚</p>
<blockquote>
<p>dns-nameservers 223.5.5.5</p>
</blockquote>
<blockquote>
<p>é‡å¯ç½‘å¡:   /etc/init.d/networking restart</p>
</blockquote>
<p>é‡å¯åDNSå°±ç”Ÿæ•ˆäº†ï¼Œè¿™æ—¶å€™å†çœ‹/etc/resolv.confï¼Œæœ€ä¸‹é¢å°±å¤šäº†ä¸€è¡Œï¼š</p>
<blockquote>
<p>#Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8) 	 	# DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN 	 	<br>
nameserver 223.5.5.5</p>
</blockquote>
</li>
<li>
<p>é‡å¯ç”µè„‘<br>
æ³¨æ„ï¼šä¸æ˜¯é‡å¯ç½‘å¡,ä¸€å®šè¦é‡å¯rebooté‡å¯ç”µè„‘æ‰è¡Œã€‚<br>
ä¸‹é¢è¿™äº›å‘½ä»¤åªèƒ½ç”¨æ¥å¯åŠ¨å’Œå…³é—­ç½‘å¡ï¼Œä½†æ˜¯ä¸èƒ½è®©ä¿®æ”¹çš„é…ç½®ç«‹å³ç”Ÿæ•ˆã€‚</p>
<blockquote>
<p>/etc/init.d/networking restart æˆ–è€…ï¼ˆä¸‹é¢æ˜¯æŒ‡å®šå¯åŠ¨å…³é—­æŸä¸ªç½‘å¡å‘½ä»¤ï¼‰ ifdown enp0s3<br>
ï¼ˆå…³é—­ç½‘å¡enp0s3ï¼‰ ifup   enp0s3    (å¯åŠ¨ç½‘å¡enp0s3)<br>
sudo service network-manager restart</p>
</blockquote>
</li>
</ol>
<p>æµ‹è¯•ï¼šping www.baidu.com<br>
<img src="https://img-blog.csdnimg.cn/20190506180838652.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM3MzM4NzYx,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"></p>
<p>å‚ç…§ï¼š<br>
1.<a href="https://blog.csdn.net/stay_zezo/article/details/80718369">ubantu16.04è”ç½‘</a><br>
2.<a href="https://wqyuu.github.io/blog/post-images/1582019587188.jpg">Virtualboxä¸‹åˆ©ç”¨host-onlyè¿æ¥æ–¹å¼å®ç°è™šæ‹Ÿæœºå’Œç‰©ç†æœºè”ç½‘ï¼ˆåŒ…æ‹¬wifiï¼‰</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Dockerä¸‹å®‰è£…ElasticSearch]]></title>
        <id>https://wqyuu.github.io/blog/post/docker-xia-an-zhuang-elasticsearch</id>
        <link href="https://wqyuu.github.io/blog/post/docker-xia-an-zhuang-elasticsearch">
        </link>
        <updated>2019-05-03T06:50:06.000Z</updated>
        <content type="html"><![CDATA[<ul>
<li>
<p><a href="https://blog.csdn.net/ityouknow/article/details/90899131">Docker å…¥é—¨åŠå®‰è£…[Docker ç³»åˆ—-1]</a></p>
</li>
<li>
<p><a href="https://blog.csdn.net/qq_37338761/article/details/90697027">Dockerå®‰è£…åŠé—®é¢˜è§£å†³(ubuntu16.04)</a></p>
</li>
<li>
<p>å…¨æ–‡æœç´¢å±äºæœ€å¸¸è§çš„éœ€æ±‚ï¼Œå¼€æºçš„ Elasticsearch ï¼ˆä»¥ä¸‹ç®€ç§° Elasticï¼‰æ˜¯ç›®å‰å…¨æ–‡æœç´¢å¼•æ“çš„é¦–é€‰ã€‚</p>
</li>
<li>
<p>å®ƒå¯ä»¥å¿«é€Ÿåœ°å‚¨å­˜ã€æœç´¢å’Œåˆ†ææµ·é‡æ•°æ®ã€‚ç»´åŸºç™¾ç§‘ã€Stack Overflowã€Github éƒ½é‡‡ç”¨å®ƒã€‚</p>
</li>
<li>
<p>Elastic çš„åº•å±‚æ˜¯å¼€æºåº“ Luceneã€‚ä½†æ˜¯ï¼Œä½ æ²¡æ³•ç›´æ¥ç”¨ Luceneï¼Œå¿…é¡»è‡ªå·±å†™ä»£ç å»è°ƒç”¨å®ƒçš„æ¥å£ã€‚Elastic æ˜¯ Lucene çš„å°è£…ï¼Œæä¾›äº† REST API çš„æ“ä½œæ¥å£ï¼Œå¼€ç®±å³ç”¨ã€‚</p>
</li>
</ul>
<h3 id="å®‰è£…elasticsearch">å®‰è£…ElasticSearch</h3>
<h4 id="1-ä»dockerä»“åº“æœç´¢elasticsearch">1. ä»dockerä»“åº“æœç´¢ElasticSearch</h4>
<pre><code class="language-shell">$ docker search elasticsearch
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://img-blog.csdnimg.cn/2019060511251850.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM3MzM4NzYx,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"></figure>
<h4 id="2é€‰æ‹©ä¸€ä¸ªç‰ˆæœ¬æ‹‰å–é•œåƒ-æˆ‘å®‰è£…çš„æ˜¯246">2.é€‰æ‹©ä¸€ä¸ªç‰ˆæœ¬ï¼Œæ‹‰å–é•œåƒã€‚æˆ‘å®‰è£…çš„æ˜¯2.4.6</h4>
<p>2.4.6æ˜¯ç›®å‰springbootæ”¯æŒçš„æœ€é«˜ç‰ˆæœ¬<br>
<img src="https://img-blog.csdnimg.cn/20190605112719550.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM3MzM4NzYx,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br>
å‚è€ƒï¼šhttps://github.com/spring-projects/spring-data-elasticsearch/wiki/Spring-Data-Elasticsearch---Spring-Boot---version-matrix</p>
<pre><code class="language-shell">$  docker pull elasticsearch:2.4.6
</code></pre>
<p>æŸ¥çœ‹é•œåƒ</p>
<pre><code class="language-shell">$  docker images
</code></pre>
<figure data-type="image" tabindex="2"><img src="https://img-blog.csdnimg.cn/20190605113028725.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"></figure>
<h4 id="3é€šè¿‡é•œåƒå¯åŠ¨ä¸€ä¸ªå®¹å™¨å¹¶å°†9200å’Œ9300ç«¯å£æ˜ å°„åˆ°æœ¬æœº">3.é€šè¿‡é•œåƒï¼Œå¯åŠ¨ä¸€ä¸ªå®¹å™¨ï¼Œå¹¶å°†9200å’Œ9300ç«¯å£æ˜ å°„åˆ°æœ¬æœº</h4>
<pre><code class="language-shell">$ docker run -d -p 9200:9200 -p 9300:9300 --name elasticsearch elasticsearch:2.4.6
</code></pre>
<h4 id="4-æŸ¥çœ‹å®¹å™¨">4. æŸ¥çœ‹å®¹å™¨</h4>
<pre><code class="language-shell">$ docker ps #æŸ¥çœ‹å·²å¯åŠ¨å®¹å™¨
$ docker ps -a #æŸ¥çœ‹æ‰€æœ‰å®¹å™¨ï¼ŒåŒ…æ‹¬åœæ­¢çš„
</code></pre>
<figure data-type="image" tabindex="3"><img src="https://img-blog.csdnimg.cn/2019060511362011.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"></figure>
<h4 id="5æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ">5.æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ</h4>
<pre><code class="language-shell">$ curl http://localhost:9200
{
  &quot;name&quot; : &quot;Sean Cassidy&quot;,
  &quot;cluster_name&quot; : &quot;elasticsearch&quot;,
  &quot;cluster_uuid&quot; : &quot;4F4r988CQsOPZZ7jbb9yWg&quot;,
  &quot;version&quot; : {
    &quot;number&quot; : &quot;2.4.6&quot;,
    &quot;build_hash&quot; : &quot;5376dca9f70f3abef96a77f4bb22720ace8240fd&quot;,
    &quot;build_timestamp&quot; : &quot;2017-07-18T12:17:44Z&quot;,
    &quot;build_snapshot&quot; : false,
    &quot;lucene_version&quot; : &quot;5.5.4&quot;
  },
  &quot;tagline&quot; : &quot;You Know, for Search&quot;
}
</code></pre>
<h3 id="å®‰è£…headæ’ä»¶">å®‰è£…headæ’ä»¶</h3>
<h4 id="1è¿›å…¥å®¹å™¨">1.è¿›å…¥å®¹å™¨</h4>
<pre><code class="language-shell">$ docker exec -it d011a9da6f79/bin/bash #d011a9da6f79ä¸ºå®¹å™¨id
</code></pre>
<p>åˆ°/binç›®å½•ä¸‹ï¼Œæ‰§è¡Œpluginå‘½ä»¤</p>
<pre><code class="language-shell">$ cd bin$ plugin install mobz/elasticsearch-head
</code></pre>
<figure data-type="image" tabindex="4"><img src="https://img-blog.csdnimg.cn/20190605113722321.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM3MzM4NzYx,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"></figure>
<h4 id="2å®‰è£…å®Œæˆåæµè§ˆå™¨è®¿é—®">2.å®‰è£…å®Œæˆåï¼Œæµè§ˆå™¨è®¿é—®</h4>
<p>http://localhost:9200/_plugin/head/</p>
<p><img src="https://img-blog.csdnimg.cn/20190605113857324.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM3MzM4NzYx,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br>
<strong>å¦‚æœå¯¹ä½ æœ‰å¸®åŠ©ï¼Œç‚¹ä¸ªèµå§ï¼</strong>ğŸ˜˜</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Zookeeperåˆ†å¸ƒå¼é”çš„ç®€å•å®ç°]]></title>
        <id>https://wqyuu.github.io/blog/post/zookeeper-fen-bu-shi-suo-de-jian-dan-shi-xian</id>
        <link href="https://wqyuu.github.io/blog/post/zookeeper-fen-bu-shi-suo-de-jian-dan-shi-xian">
        </link>
        <updated>2019-05-01T02:41:27.000Z</updated>
        <content type="html"><![CDATA[<p><em><strong>ä½¿ç”¨InterProcessMutexå®ç°</strong></em></p>
<blockquote>
<p>InterProcessMutexåŸºäºZookeeperå®ç°äº†åˆ†å¸ƒå¼çš„å…¬å¹³å¯é‡å…¥äº’æ–¥é”ï¼Œç±»ä¼¼äºå•ä¸ªJVMè¿›ç¨‹å†…çš„ReentrantLock</p>
</blockquote>
<h3 id="1åˆå§‹åŒ–interprocessmutex">1.åˆå§‹åŒ–InterProcessMutex</h3>
<pre><code class="language-java">private  static InterProcessMutex mutex = new InterProcessMutex(client, &quot;/curator/lock&quot;); 
</code></pre>
<h3 id="2è·å–é”">2.è·å–é”</h3>
<pre><code class="language-java">    //è·å¾—äº†é”
    public static boolean acquire(long time, TimeUnit unit){
    	try {
			return mutex.acquire(time,unit);
		} catch (Exception e) {
			e.printStackTrace();
			return false;
		}
    }
</code></pre>
<h3 id="3é‡Šæ”¾é”">3.é‡Šæ”¾é”</h3>
<pre><code class="language-java">    //é‡Šæ”¾é”
    public static void release(){
    	try {
			mutex.release();
		} catch (Exception e) {
			e.printStackTrace();
		}
    }
</code></pre>
<h3 id="æµ‹è¯•">æµ‹è¯•ï¼š</h3>
<pre><code class="language-java">import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

import org.apache.curator.RetryPolicy;
import org.apache.curator.framework.CuratorFramework;
import org.apache.curator.framework.CuratorFrameworkFactory;
import org.apache.curator.framework.recipes.locks.InterProcessMutex;
import org.apache.curator.retry.ExponentialBackoffRetry;
/**
 * åŸºäºcuratorçš„zookeeperåˆ†å¸ƒå¼é”
 * è¿™é‡Œæˆ‘ä»¬å¼€å¯5ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹è·å–é”çš„æœ€å¤§ç­‰å¾…æ—¶é—´ä¸º5ç§’ï¼Œä¸ºäº†æ¨¡æ‹Ÿå…·ä½“ä¸šåŠ¡åœºæ™¯ï¼Œæ–¹æ³•ä¸­è®¾ç½®4ç§’ç­‰å¾…æ—¶é—´ã€‚
 * 
 */
public class CuratorUtil {
    private static String address = &quot;192.168.12.101:2181&quot;;
	
    public static void main(String[] args) {
		//1ã€é‡è¯•ç­–ç•¥ï¼šåˆè¯•æ—¶é—´ä¸º1s é‡è¯•3æ¬¡
		RetryPolicy retryPolicy = new ExponentialBackoffRetry(1000, 3); 
		//2ã€é€šè¿‡å·¥å‚åˆ›å»ºè¿æ¥
		CuratorFramework client = CuratorFrameworkFactory.newClient(address, retryPolicy);
        //3ã€å¼€å¯è¿æ¥
        client.start();
        //4 åˆ†å¸ƒå¼é”
        final InterProcessMutex mutex = new InterProcessMutex(client, &quot;/curator/lock&quot;); 
        //è¯»å†™é”
        //InterProcessReadWriteLock readWriteLock = new InterProcessReadWriteLock(client, &quot;/readwriter&quot;);
        
        ExecutorService fixedThreadPool = Executors.newFixedThreadPool(5);
        
        for (int i = 0; i &lt; 5; i++) {
            fixedThreadPool.submit(new Runnable() {
                @Override
                public void run() {
                	boolean flag = false;
                	try {
                		//å°è¯•è·å–é”ï¼Œæœ€å¤šç­‰å¾…5ç§’
                		flag = mutex.acquire(5, TimeUnit.SECONDS);
                		Thread currentThread = Thread.currentThread();
                		if(flag){
                			System.out.println(&quot;çº¿ç¨‹&quot;+currentThread.getId()+&quot;è·å–é”æˆåŠŸ&quot;);
                		}else{
                			System.out.println(&quot;çº¿ç¨‹&quot;+currentThread.getId()+&quot;è·å–é”å¤±è´¥&quot;);
                		}
                		//æ¨¡æ‹Ÿä¸šåŠ¡é€»è¾‘ï¼Œå»¶æ—¶4ç§’
                		Thread.sleep(4000);
					} catch (Exception e) {
						e.printStackTrace();
					} finally{
						if(flag){
							try {
								mutex.release();
							} catch (Exception e) {
								e.printStackTrace();
							}
						}
					}
                }
            });
        }
	}
}
</code></pre>
<p>è¿™é‡Œæˆ‘ä»¬å¼€å¯5ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹è·å–é”çš„æœ€å¤§ç­‰å¾…æ—¶é—´ä¸º5ç§’ï¼Œä¸ºäº†æ¨¡æ‹Ÿå…·ä½“ä¸šåŠ¡åœºæ™¯ï¼Œæ–¹æ³•ä¸­è®¾ç½®4ç§’ç­‰å¾…æ—¶é—´ã€‚å¼€å§‹æ‰§è¡Œmainæ–¹æ³•ï¼Œé€šè¿‡ZooInspectorç›‘æ§/curator/lockä¸‹çš„èŠ‚ç‚¹å¦‚ä¸‹å›¾ï¼š</p>
<figure data-type="image" tabindex="1"><img src="https://img-blog.csdnimg.cn/20190826210337845.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM3MzM4NzYx,size_16,color_FFFFFF,t_70" alt="ZooInspectorç›‘æ§" loading="lazy"></figure>
<p>å¯¹ï¼Œæ²¡é”™ï¼Œè®¾ç½®4ç§’çš„ä¸šåŠ¡å¤„ç†æ—¶é•¿å°±æ˜¯ä¸ºäº†è§‚å¯Ÿç”Ÿæˆäº†å‡ ä¸ªé¡ºåºèŠ‚ç‚¹ã€‚æœç„¶å¦‚æ¡ˆä¾‹ä¸­æ‰€è¿°ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½ä¼šç”Ÿæˆä¸€ä¸ªèŠ‚ç‚¹å¹¶ä¸”è¿˜æ˜¯æœ‰åºçš„ã€‚è§‚å¯Ÿæ§åˆ¶å°ï¼Œæˆ‘ä»¬ä¼šå‘ç°åªæœ‰ä¸¤ä¸ªçº¿ç¨‹è·å–é”æˆåŠŸï¼Œå¦å¤–ä¸‰ä¸ªçº¿ç¨‹è¶…æ—¶è·å–é”å¤±è´¥ä¼šè‡ªåŠ¨åˆ é™¤èŠ‚ç‚¹ã€‚çº¿ç¨‹æ‰§è¡Œå®Œæ¯•æˆ‘ä»¬åˆ·æ–°ä¸€ä¸‹/curator/lockèŠ‚ç‚¹ï¼Œå‘ç°åˆšæ‰åˆ›å»ºçš„äº”ä¸ªå­èŠ‚ç‚¹å·²ç»ä¸å­˜åœ¨äº†ã€‚</p>
<p>InterProcessMutexæºç åˆ†æ:<br>
<a href="https://www.cnblogs.com/shileibrave/p/9854921.html">https://www.cnblogs.com/shileibrave/p/9854921.html</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Zookeeperçš„Javaå®¢æˆ·ç«¯Curator(6)]]></title>
        <id>https://wqyuu.github.io/blog/post/zookeeper-de-java-ke-hu-duan-curator6</id>
        <link href="https://wqyuu.github.io/blog/post/zookeeper-de-java-ke-hu-duan-curator6">
        </link>
        <updated>2019-04-30T11:39:50.000Z</updated>
        <content type="html"><![CDATA[<h3 id="å®è·µ6-è®¤è¯æˆæƒ">å®è·µ6 è®¤è¯æˆæƒ</h3>
<h5 id="1é€’å½’æƒé™">1.é€’å½’æƒé™</h5>
<ul>
<li>creatingParentsIfNeeded()ï¼šçˆ¶èŠ‚ç‚¹ä¸å­˜åœ¨ã€‚é€’å½’åˆ›å»ºèŠ‚</li>
<li>CreateMode.PERSISTENTï¼šé€’å½’åˆ›å»º</li>
<li>withACL()è®¾ç½®èŠ‚ç‚¹æƒé™</li>
<li>withACL(acls, true) é€’å½’è®¾ç½®èŠ‚ç‚¹æƒé™</li>
</ul>
<pre><code class="language-java">		// å®ä¾‹åŒ–
		CuratorAcl cto = new CuratorAcl();
		boolean isZkCuratorStarted = cto.client.isStarted();
		System.out.println(&quot;å½“å‰å®¢æˆ·çš„çŠ¶æ€ï¼š&quot; + (isZkCuratorStarted ? &quot;è¿æ¥ä¸­&quot; : &quot;å·²å…³é—­&quot;));
		
		String nodePath = &quot;/acl/father/child/sub&quot;;
		
		List&lt;ACL&gt; acls = new ArrayList&lt;ACL&gt;();
		Id imooc1 = new Id(&quot;digest&quot;, AclUtils.getDigestUserPwd(&quot;imooc1:123456&quot;));
		Id imooc2 = new Id(&quot;digest&quot;, AclUtils.getDigestUserPwd(&quot;imooc2:123456&quot;));
		acls.add(new ACL(Perms.ALL, imooc1));
		acls.add(new ACL(Perms.READ, imooc2));
		acls.add(new ACL(Perms.DELETE | Perms.CREATE, imooc2));
		
		// åˆ›å»ºèŠ‚ç‚¹
		byte[] data = &quot;spiderman&quot;.getBytes();
		cto.client.create().creatingParentsIfNeeded()
				.withMode(CreateMode.PERSISTENT)
				.withACL(acls, true)
				.forPath(nodePath, data);
</code></pre>
<h5 id="2è®¾ç½®å•èŠ‚ç‚¹æƒé™">2.è®¾ç½®å•èŠ‚ç‚¹æƒé™</h5>
<p>å¦‚æœæƒ³ä¿®æ”¹å·²æœ‰èŠ‚ç‚¹çš„æƒé™ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢æ–¹æ³•ï¼š</p>
<pre><code class="language-java">cto.client.setACL().withACL(acls).forPath(&quot;/curatorNode&quot;);
</code></pre>
<h5 id="3åˆ›å»ºæ—¶æˆæƒ">3.åˆ›å»ºæ—¶æˆæƒ</h5>
<p>åˆ›å»ºæ—¶æˆæƒæ‰å¯ä»¥é€’å½’å¯¹èŠ‚ç‚¹åˆ›å»ºæˆæƒ<br>
çˆ¶èŠ‚ç‚¹æˆæƒæ—¶ï¼Œç”¨æˆ·é»˜è®¤æƒé™æ²¡åŠæ³•è®¿é—®è¿™ä¸ªèŠ‚ç‚¹ï¼Œæ‰€ä»¥éœ€è¦æˆæƒ</p>
<pre><code class="language-java">RetryPolicy retryPolicy = new RetryNTimes(3, 5000);
		client = CuratorFrameworkFactory.builder().authorization(&quot;digest&quot;, &quot;imooc:123456&quot;.getBytes())
				.connectString(zkServerPath)
				.sessionTimeoutMs(10000).retryPolicy(retryPolicy)
				.namespace(&quot;workspace&quot;).build();
		client.start();
</code></pre>
<h5 id="4æµ‹è¯•æƒé™">4.æµ‹è¯•æƒé™</h5>
<pre><code class="language-java">		// æ›´æ–°èŠ‚ç‚¹æ•°æ®
		byte[] newData = &quot;batman&quot;.getBytes();
		cto.client.setData().withVersion(0).forPath(nodePath, newData);
</code></pre>
<p>åˆå§‹åŒ–ä½¿ç”¨ç”¨æˆ·imoocæˆæƒï¼Œå¯¹èŠ‚ç‚¹ä¿®æ”¹æ•°æ®ä¼šæŠ¥é”™:no Auth<br>
åˆ‡æ¢ä¸ºimoocç”¨æˆ·å¯ä»¥æ­£å¸¸è¿›è¡Œä¿®æ”¹</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Zookeeperçš„Javaå®¢æˆ·ç«¯Curator(5)]]></title>
        <id>https://wqyuu.github.io/blog/post/zookeeper-de-java-ke-hu-duan-curator5</id>
        <link href="https://wqyuu.github.io/blog/post/zookeeper-de-java-ke-hu-duan-curator5">
        </link>
        <updated>2019-04-28T01:37:27.000Z</updated>
        <content type="html"><![CDATA[<h3 id="å®è·µ5-ç›‘å¬å­èŠ‚ç‚¹">å®è·µ5  ç›‘å¬å­èŠ‚ç‚¹</h3>
<p>StartModeä¸€èˆ¬é€‰POST_INITIALIZED_EVENTï¼Œè¿™ä¸ªä¼šæœ‰æé†’åˆå§‹åŒ–æˆåŠŸ<br>
å¦‚æœæƒ³ç»†è‡´åˆ°å¯¹æŸä¸ªèŠ‚ç‚¹çš„ç›‘å¬ï¼Œå¯ä»¥è·å–èŠ‚ç‚¹çš„è·¯å¾„ï¼š String path = event.getData().getPath(); åˆ¤æ–­è¿™ä¸ªè·¯å¾„æ¥ç¡®å®šèŠ‚ç‚¹åˆ›å»ºæˆåŠŸå¤±è´¥</p>
<pre><code class="language-java">final static String ADD_PATH = &quot;/super/imooc/d&quot;;


// ä¸ºå­èŠ‚ç‚¹æ·»åŠ watcher
// PathChildrenCache: ç›‘å¬æ•°æ®èŠ‚ç‚¹çš„å¢åˆ æ”¹ï¼Œä¼šè§¦å‘äº‹ä»¶
String childNodePathCache =  nodePath;// cacheData: è®¾ç½®ç¼“å­˜èŠ‚ç‚¹çš„æ•°æ®çŠ¶æ€
final PathChildrenCache childrenCache = new PathChildrenCache(cto.client, childNodePathCache, true);
/**
 * StartMode: åˆå§‹åŒ–æ–¹å¼
 * POST_INITIALIZED_EVENTï¼šå¼‚æ­¥åˆå§‹åŒ–ï¼Œåˆå§‹åŒ–ä¹‹åä¼šè§¦å‘äº‹ä»¶
 * NORMALï¼šå¼‚æ­¥åˆå§‹åŒ–
 * BUILD_INITIAL_CACHEï¼šåŒæ­¥åˆå§‹åŒ–
 */
childrenCache.start(StartMode.POST_INITIALIZED_EVENT);
		
List&lt;ChildData&gt; childDataList = childrenCache.getCurrentData();
System.out.println(&quot;å½“å‰æ•°æ®èŠ‚ç‚¹çš„å­èŠ‚ç‚¹æ•°æ®åˆ—è¡¨ï¼š&quot;);
for (ChildData cd : childDataList) {
	String childData = new String(cd.getData());
	System.out.println(childData);
}
childrenCache.getListenable().addListener(new PathChildrenCacheListener() {
        public void childEvent(CuratorFramework client,PathChildrenCacheEvent event) throws Exception {
                if(event.getType().equals(PathChildrenCacheEvent.Type.INITIALIZED)){
                  System.out.println(&quot;å­èŠ‚ç‚¹åˆå§‹åŒ–ok...&quot;);
                }else if(event.getType().equals(PathChildrenCacheEvent.Type.CHILD_ADDED)){
                  String path = event.getData().getPath();
                  if (path.equals(ADD_PATH)) {
                        System.out.println(&quot;æ·»åŠ å­èŠ‚ç‚¹:&quot; + event.getData().getPath());
                        System.out.println(&quot;å­èŠ‚ç‚¹æ•°æ®:&quot; + new String(event.getData().getData()));
                    } else if (path.equals(&quot;/super/imooc/e&quot;)) {
                        System.out.println(&quot;æ·»åŠ ä¸æ­£ç¡®...&quot;);
                    }

                }else if(event.getType().equals(PathChildrenCacheEvent.Type.CHILD_REMOVED)){
                    System.out.println(&quot;åˆ é™¤å­èŠ‚ç‚¹:&quot; + event.getData().getPath());
                }else if(event.getType().equals(PathChildrenCacheEvent.Type.CHILD_UPDATED)){
                    System.out.println(&quot;ä¿®æ”¹å­èŠ‚ç‚¹è·¯å¾„:&quot; + event.getData().getPath());
                    System.out.println(&quot;ä¿®æ”¹å­èŠ‚ç‚¹æ•°æ®:&quot; + new String(event.getData().getData()));
                }
            }
});



</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Zookeeperçš„Javaå®¢æˆ·ç«¯Curator(4)]]></title>
        <id>https://wqyuu.github.io/blog/post/zookeeper-de-java-ke-hu-duan-curator4</id>
        <link href="https://wqyuu.github.io/blog/post/zookeeper-de-java-ke-hu-duan-curator4">
        </link>
        <updated>2019-04-26T13:40:08.000Z</updated>
        <content type="html"><![CDATA[<h3 id="å®è·µ4">å®è·µ4</h3>
<h4 id="1watcher-äº‹ä»¶">1.watcher äº‹ä»¶</h4>
<p>å½“ä½¿ç”¨usingWatcherçš„æ—¶å€™ï¼Œç›‘å¬åªä¼šè§¦å‘ä¸€æ¬¡ï¼Œç›‘å¬å®Œæ¯•åå°±é”€æ¯</p>
<pre><code class="language-java">// watcher äº‹ä»¶  å½“ä½¿ç”¨usingWatcherçš„æ—¶å€™ï¼Œç›‘å¬åªä¼šè§¦å‘ä¸€æ¬¡ï¼Œç›‘å¬å®Œæ¯•åå°±é”€æ¯
cto.client.getData().usingWatcher(new MyCuratorWatcher()).forPath(nodePath);
//cto.client.getData().usingWatcher(new MyWatcher()).forPath(nodePath);
</code></pre>
<h4 id="2ç›‘å¬ç¼“å­˜">2.ç›‘å¬ç¼“å­˜</h4>
<blockquote>
<ul>
<li>NodeCache: ç›‘å¬æ•°æ®èŠ‚ç‚¹çš„å˜æ›´ï¼Œä¼šè§¦å‘äº‹ä»¶ã€‚ä¸€ç›´è¿è¡Œç›‘å¬ï¼Œå¢åˆ æ”¹æ“ä½œéƒ½ä¼šè¾“å‡ºèŠ‚ç‚¹ä¿¡æ¯ nodePathä¸ºç›‘å¬è·¯å¾„ã€‚</li>
<li>nodeCache.start(true);ä¸ºå¼€å¯ç›‘å¬ åˆå§‹åŒ–ä½¿ç”¨trueï¼Œå¯ä»¥åœ¨è·å–å®¢æˆ·ç«¯è¿›è¡Œè¿æ¥æ—¶èŠ‚ç‚¹çš„æ•°æ®ã€‚</li>
<li>nodeCache.getListenable()<br>
è·å–æ‰€æœ‰ç›‘å¬åˆ—è¡¨ã€‚nodeCache.getListenable()ä¹Ÿæœ‰removeäº‹ä»¶ï¼Œç”¨æ¥ç§»é™¤ç›‘å¬ã€‚</li>
<li>åªè¦æœ‰äº‹ä»¶å‘ç”Ÿå°±ä¼šè§¦å‘NodeCacheListenerçš„nodeChanged()æ–¹æ³•</li>
</ul>
</blockquote>
<pre><code class="language-java">// ä¸ºèŠ‚ç‚¹æ·»åŠ watcher
// NodeCache: ç›‘å¬æ•°æ®èŠ‚ç‚¹çš„å˜æ›´ï¼Œä¼šè§¦å‘äº‹ä»¶
final NodeCache nodeCache = new NodeCache(cto.client, nodePath);
// buildInitial : åˆå§‹åŒ–çš„æ—¶å€™è·å–nodeçš„å€¼å¹¶ä¸”ç¼“å­˜
nodeCache.start(true);
if (nodeCache.getCurrentData() != null) {
	System.out.println(&quot;èŠ‚ç‚¹åˆå§‹åŒ–æ•°æ®ä¸ºï¼š&quot; + new String(nodeCache.getCurrentData().getData()));
} else {
	System.out.println(&quot;èŠ‚ç‚¹åˆå§‹åŒ–æ•°æ®ä¸ºç©º...&quot;);
}
nodeCache.getListenable().addListener(new NodeCacheListener() {
	public void nodeChanged() throws Exception {
		if (nodeCache.getCurrentData() == null) {
			System.out.println(&quot;ç©º&quot;);
			return;
		}
		String data = new String(nodeCache.getCurrentData().getData());
		System.out.println(&quot;èŠ‚ç‚¹è·¯å¾„ï¼š&quot; + nodeCache.getCurrentData().getPath() + &quot;æ•°æ®ï¼š&quot; + data);
	}
});
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Zookeeperçš„Javaå®¢æˆ·ç«¯Curator(3)]]></title>
        <id>https://wqyuu.github.io/blog/post/zookeeper-de-java-ke-hu-duan-curator3</id>
        <link href="https://wqyuu.github.io/blog/post/zookeeper-de-java-ke-hu-duan-curator3">
        </link>
        <updated>2019-04-22T12:33:24.000Z</updated>
        <content type="html"><![CDATA[<h3 id="å®è·µ3">å®è·µ3</h3>
<h4 id="1è¯»å–èŠ‚ç‚¹æ•°æ®">1.è¯»å–èŠ‚ç‚¹æ•°æ®</h4>
<p>storingStatInæ‹¿åˆ°Statä¿¡æ¯ï¼Œå¹¶è¿›è¡Œå­˜å‚¨</p>
<pre><code class="language-java">// è¯»å–èŠ‚ç‚¹æ•°æ®
Stat stat = new Stat();
byte[] data = cto.client.getData().storingStatIn(stat).forPath(nodePath);
System.out.println(&quot;èŠ‚ç‚¹&quot; + nodePath + &quot;çš„æ•°æ®ä¸º: &quot; + new String(data));
System.out.println(&quot;è¯¥èŠ‚ç‚¹çš„ç‰ˆæœ¬å·ä¸º: &quot; + stat.getVersion());
</code></pre>
<h4 id="2æŸ¥è¯¢å­èŠ‚ç‚¹">2.æŸ¥è¯¢å­èŠ‚ç‚¹</h4>
<pre><code class="language-java">
// æŸ¥è¯¢å­èŠ‚ç‚¹
List&lt;String&gt; childNodes = cto.client.getChildren()
									.forPath(nodePath);
System.out.println(&quot;å¼€å§‹æ‰“å°å­èŠ‚ç‚¹ï¼š&quot;);
for (String s : childNodes) {
	System.out.println(s);
}
</code></pre>
<h4 id="3åˆ¤æ–­èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨">3.åˆ¤æ–­èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨</h4>
<pre><code class="language-java">// åˆ¤æ–­èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨,å¦‚æœä¸å­˜åœ¨åˆ™ä¸ºç©º
Stat statExist = cto.client.checkExists().forPath(nodePath + &quot;/it7&quot;);
System.out.println(statExist);
</code></pre>
]]></content>
    </entry>
</feed>