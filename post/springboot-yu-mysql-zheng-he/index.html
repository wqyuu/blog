
<!DOCTYPE html>
<html>
  <head>
    
<meta charset="utf-8" >

<title> SpringBootä¸Mysqlæ•´åˆ | Wqyuu</title>
<meta name="description" content="ç§‰å¿ è´ä¹‹å¿—,å®ˆè°¦é€€ä¹‹èŠ‚">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://wqyuu.github.io/blog/favicon.ico?v=1582013282909">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://wqyuu.github.io/blog/styles/main.css">


  
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  

  


<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



  </head>
  <body>
    <div id="app" class="main">
      <div class="site-header-container">
  <div class="site-header">
    <div class="left">
      <a href="https://wqyuu.github.io/blog">
        <img class="avatar" src="https://wqyuu.github.io/blog/images/avatar.png?v=1582013282909" alt="" width="32px" height="32px">
      </a>
      <a href="https://wqyuu.github.io/blog">
        <h1 class="site-title">Wqyuu</h1>
      </a>
    </div>
    <div class="right">
      <transition name="fade">
        <i class="icon" :class="{ 'icon-close-outline': menuVisible, 'icon-menu-outline': !menuVisible }" @click="menuVisible = !menuVisible"></i>
      </transition>
    </div>
  </div>
</div>

<transition name="fade">
  <div class="menu-container" style="display: none;" v-show="menuVisible">
    <div class="menu-list">
      
        
          <a href="https://wqyuu.github.io/blog" class="menu purple-link">
            é¦–é¡µ
          </a>
        
      
        
          <a href="https://wqyuu.github.io/blog/archives" class="menu purple-link">
            å½’æ¡£
          </a>
        
      
        
          <a href="https://wqyuu.github.io/blog/tags" class="menu purple-link">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="https://wqyuu.github.io/blog/post/about" class="menu purple-link">
            å…³äº
          </a>
        
      
    </div>
  </div>
</transition>


      <div class="content-container">
        <div class="post-detail">
          
            <div class="feature-container" style="background-image: url('https://wqyuu.github.io/blog/post-images/springboot-yu-mysql-zheng-he.jpg')">
            </div>
          
          <h2 class="post-title"> SpringBootä¸Mysqlæ•´åˆ</h2>
          <div class="post-info post-detail-info">
            <span><i class="icon-calendar-outline"></i> 2019-03-18</span>
            
              <span>
                <i class="icon-pricetags-outline"></i>
                
                  <a href="https://wqyuu.github.io/blog/tag/springboot">
                    springboot
                    
                  </a>
                
              </span>
            
          </div>
          <div class="post-content">
            <p>ğŸ˜<br>
ç®€ä»‹ï¼šä½¿ç”¨JPAæ•´åˆMysql</p>
<!-- more -->
<p>å¼€å§‹å‡†å¤‡ï¼š</p>
<ul>
<li>Mysqlæ•°æ®åº“</li>
<li>æ­å»ºå¥½çš„springbootçš„demo</li>
<li>IDEA</li>
</ul>
<p>æ­å»ºspringbootçš„demoåŠå¼€å‘ç¯å¢ƒå¯ä»¥æŸ¥çœ‹ä¸Šä¸€ç¯‡<br>
<a href="https://blog.csdn.net/qq_37338761/article/details/100113153">SpringBootçŸ¥è¯†ä½“ç³»ï¼ˆä¸€ï¼‰â€”â€”ç®€å•å›¾è§£ä»é›¶æ­å»ºSpringBoot</a></p>
<p><ul class="markdownIt-TOC">
<li>
<ul>
<li>
<ul>
<li><a href="#%E4%B8%80%E6%B7%BB%E5%8A%A0%E8%AE%BF%E9%97%AE%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9B%B8%E5%85%B3%E4%BE%9D%E8%B5%96">ä¸€.æ·»åŠ è®¿é—®æ•°æ®åº“ç›¸å…³ä¾èµ–!</a></li>
<li><a href="#%E4%BA%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7%E8%A1%A8">äºŒ.æ•°æ®åº“åˆ›å»ºç”¨æˆ·è¡¨</a></li>
<li><a href="#%E4%B8%89%E5%A2%9E%E5%8A%A0mysql%E8%BF%9E%E6%8E%A5%E4%BF%A1%E6%81%AF">ä¸‰.å¢åŠ Mysqlè¿æ¥ä¿¡æ¯</a></li>
<li><a href="#%E5%9B%9B%E5%A2%9E%E5%8A%A0jpa%E9%85%8D%E7%BD%AE">å››.å¢åŠ JPAé…ç½®</a></li>
<li><a href="#%E4%BA%94%E5%88%9B%E5%BB%BA%E5%AE%9E%E4%BD%93%E7%B1%BB">äº”.åˆ›å»ºå®ä½“ç±»</a></li>
<li><a href="#%E5%85%AD%E5%88%9B%E5%BB%BAdao%E5%B1%82%E6%8E%A5%E5%8F%A3userrepository">å…­.åˆ›å»ºDAOå±‚æ¥å£UserRepository</a></li>
<li><a href="#%E4%B8%83%E5%88%9B%E5%BB%BA%E6%B5%8B%E8%AF%95%E7%B1%BB">ä¸ƒ.åˆ›å»ºæµ‹è¯•ç±»</a>
<ul>
<li><a href="#1%E4%BF%AE%E6%94%B9applicationtest">(1)ä¿®æ”¹ApplicationTest:</a></li>
<li><a href="#2%E5%9C%A8repository%E5%8C%85%E4%B8%8B%E5%88%9B%E5%BB%BAuserrepositorytest">(2)åœ¨repositoryåŒ…ä¸‹åˆ›å»ºUserRepositoryTest</a></li>
<li><a href="#3%E8%BF%90%E8%A1%8C%E6%B5%8B%E8%AF%95">(3)è¿è¡Œæµ‹è¯•</a></li>
</ul>
</li>
<li><a href="#%E5%85%AB%E5%8F%AF%E8%83%BD%E5%87%BA%E7%8E%B0%E7%9A%84%E6%8A%A5%E9%94%99">å…«.å¯èƒ½å‡ºç°çš„æŠ¥é”™</a>
<ul>
<li><a href="#1%E8%BF%90%E8%A1%8C%E6%97%B6%E5%87%BA%E7%8E%B0hibernatedialect-not-set">(1ï¼‰è¿è¡Œæ—¶å‡ºç°'hibernate.dialect' not set</a></li>
<li><a href="#2%E8%BF%90%E8%A1%8C%E6%97%B6%E5%87%BA%E7%8E%B0no-spring-session-store-is-configured">(2ï¼‰è¿è¡Œæ—¶å‡ºç°No Spring Session store is configured</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</p>
<h3 id="ä¸€æ·»åŠ è®¿é—®æ•°æ®åº“ç›¸å…³ä¾èµ–">ä¸€.æ·»åŠ è®¿é—®æ•°æ®åº“ç›¸å…³ä¾èµ–<img src="https://wqyuu.github.io/blog/post-images/1582010758165.jpg" alt="" loading="lazy"></h3>
<pre><code class="language-xml">       &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.h2database&lt;/groupId&gt;
            &lt;artifactId&gt;h2&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;mysql&lt;/groupId&gt;
            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
        &lt;/dependency&gt;
</code></pre>
<h3 id="äºŒæ•°æ®åº“åˆ›å»ºç”¨æˆ·è¡¨">äºŒ.æ•°æ®åº“åˆ›å»ºç”¨æˆ·è¡¨</h3>
<pre><code class="language-sql">DROP TABLE IF EXISTS `user`;
CREATE TABLE `user` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT COMMENT 'ç”¨æˆ·å”¯ä¸€id',
  `name` varchar(32) DEFAULT NULL COMMENT 'ç”¨æˆ·å',
  `email` varchar(32) DEFAULT NULL COMMENT 'ç”µå­é‚®ç®±',
  `phone_number` varchar(15) NOT NULL COMMENT 'ç”µè¯å·ç ',
  `password` varchar(32) DEFAULT NULL COMMENT 'å¯†ç ',
  `status` int(2) unsigned NOT NULL DEFAULT '0' COMMENT 'ç”¨æˆ·çŠ¶æ€ 0-æ­£å¸¸ 1-å°ç¦',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'ç”¨æˆ·è´¦å·åˆ›å»ºæ—¶é—´',
  `last_login_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'ä¸Šæ¬¡ç™»å½•æ—¶é—´',
  `last_update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'ä¸Šæ¬¡æ›´æ–°è®°å½•æ—¶é—´',
  `avatar` varchar(255) DEFAULT NULL COMMENT 'å¤´åƒ',
  PRIMARY KEY (`id`),
  UNIQUE KEY `index_on_phone` (`phone_number`) USING BTREE COMMENT 'ç”¨æˆ·æ‰‹æœºå·',
  UNIQUE KEY `index_on_username` (`name`) USING BTREE COMMENT 'ç”¨æˆ·åç´¢å¼•',
  UNIQUE KEY `index_on_email` (`email`) USING BTREE COMMENT 'ç”µå­é‚®ç®±ç´¢å¼•'
) ENGINE=InnoDB AUTO_INCREMENT=9 
DEFAULT CHARSET=utf8mb4 COMMENT='ç”¨æˆ·åŸºæœ¬ä¿¡æ¯è¡¨';

</code></pre>
<h3 id="ä¸‰å¢åŠ mysqlè¿æ¥ä¿¡æ¯">ä¸‰.å¢åŠ Mysqlè¿æ¥ä¿¡æ¯</h3>
<pre><code class="language-java">#Mysql
spring.datasource.driver-class-name=com.mysql.jdbc.Driver
spring.datasource.url=jdbc:mysql://127.0.0.1:3306/wqy01?useUnicode=true&amp;characterEncoding=UTF-8
spring.datasource.username=root
spring.datasource.password=123

#jpa
spring.jpa.show-sql=true
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.database-platform=org.hibernate.dialect.MySQLDialect
</code></pre>
<h3 id="å››å¢åŠ jpaé…ç½®">å››.å¢åŠ JPAé…ç½®</h3>
<p>åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºconfigåŒ…ï¼Œåˆ›å»ºJPAConfig ç±»</p>
<pre><code class="language-java">import org.springframework.boot.autoconfigure.jdbc.DataSourceBuilder;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;
import org.springframework.orm.jpa.JpaTransactionManager;
import org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;
import org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;
import org.springframework.transaction.PlatformTransactionManager;
import org.springframework.transaction.annotation.EnableTransactionManagement;

import javax.persistence.EntityManagerFactory;
import javax.sql.DataSource;

@Configuration
@EnableJpaRepositories(basePackages = &quot;com.wqy.springbootes.repository&quot;)
@EnableTransactionManagement
public class JPAConfig {

    @Bean
    @ConfigurationProperties(prefix = &quot;spring.datasource&quot;)
    public DataSource dataSource(){
        return DataSourceBuilder.create().build();
    }

    @Bean
    public LocalContainerEntityManagerFactoryBean entityManagerFactory(){
        HibernateJpaVendorAdapter jpaVendorAdapter = new HibernateJpaVendorAdapter();
        jpaVendorAdapter.setGenerateDdl(false);
        LocalContainerEntityManagerFactoryBean entityManagerFactoryBean =
                new LocalContainerEntityManagerFactoryBean();
        entityManagerFactoryBean.setDataSource(dataSource());
        entityManagerFactoryBean.setJpaVendorAdapter(jpaVendorAdapter);
        entityManagerFactoryBean.setPackagesToScan(&quot;com.wqy.springbootes.entity&quot;);

        return entityManagerFactoryBean;
    }

    @Bean
    public PlatformTransactionManager transactionManager(EntityManagerFactory entityManagerFactory){

        JpaTransactionManager transactionManager = new JpaTransactionManager();
        transactionManager.setEntityManagerFactory(entityManagerFactory);
        return transactionManager;
    }

}
</code></pre>
<h3 id="äº”åˆ›å»ºå®ä½“ç±»">äº”.åˆ›å»ºå®ä½“ç±»</h3>
<p>åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºentityåŒ…ï¼Œåˆ›å»ºUserç±»,çœç•¥set/get</p>
<pre><code class="language-java">import javax.persistence.*;
import java.util.Date;

@Entity
@Table(name = &quot;user&quot;)
public class User {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    private String name;

    private String password;

    private String email;

    @Column(name = &quot;phone_number&quot;)
    private String phoneNumber;

    private int status;

    @Column(name = &quot;create_time&quot;)
    private Date createTime;

    @Column(name = &quot;last_login_time&quot;)
    private Date lastLoginTime;

    @Column(name = &quot;last_update_time&quot;)
    private Date lastUpdateTime;

    private String avatar;
}    
</code></pre>
<h3 id="å…­åˆ›å»ºdaoå±‚æ¥å£userrepository">å…­.åˆ›å»ºDAOå±‚æ¥å£UserRepository</h3>
<p>åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºrepositoryåŒ…ï¼Œåˆ›å»ºUserRepositoryç±»ï¼Œé›†æˆCrudRepository</p>
<pre><code class="language-java">import com.wqy.springbootes.entity.User;
import org.springframework.data.repository.CrudRepository;

public interface UserRepository extends CrudRepository&lt;User,Long&gt; {
}
</code></pre>
<h3 id="ä¸ƒåˆ›å»ºæµ‹è¯•ç±»">ä¸ƒ.åˆ›å»ºæµ‹è¯•ç±»</h3>
<p>åœ¨æµ‹è¯•ç±»æ ¹ç›®å½•ä¸‹åˆ›å»ºrepositoryåŒ…</p>
<h4 id="1ä¿®æ”¹applicationtest">(1)ä¿®æ”¹ApplicationTest:</h4>
<pre><code class="language-java">
import org.junit.runner.RunWith;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.context.annotation.Configuration;
import org.springframework.test.context.ActiveProfiles;
import org.springframework.test.context.junit4.SpringRunner;

@RunWith(SpringRunner.class)
@SpringBootTest
@Configuration
public class SpringbootEsApplicationTests {
}
</code></pre>
<h4 id="2åœ¨repositoryåŒ…ä¸‹åˆ›å»ºuserrepositorytest">(2)åœ¨repositoryåŒ…ä¸‹åˆ›å»ºUserRepositoryTest</h4>
<pre><code class="language-java">public class UserRepositoryTest extends SpringbootEsApplicationTests {

    @Autowired
    private UserRepository userRepository;

    @Test
    public void test(){
        User user = userRepository.findOne(1001L);
        Assert.assertEquals(&quot;25490@163.com&quot;,user.getEmail());
    }
}
</code></pre>
<h4 id="3è¿è¡Œæµ‹è¯•">(3)è¿è¡Œæµ‹è¯•</h4>
<p><em>consoleè¿è¡Œæ— æŠ¥é”™ï¼ŒOKï¼</em></p>
<h3 id="å…«å¯èƒ½å‡ºç°çš„æŠ¥é”™">å…«.å¯èƒ½å‡ºç°çš„æŠ¥é”™</h3>
<h4 id="1è¿è¡Œæ—¶å‡ºç°hibernatedialect-not-set">(1ï¼‰è¿è¡Œæ—¶å‡ºç°'hibernate.dialect' not set</h4>
<p>å¯ä»¥ç‚¹å‡»æŸ¥çœ‹<a href="https://blog.csdn.net/qq_37338761/article/details/100113845">springbootçš„æ•°æ®åº“è®¾ç½®æŠ¥é”™è§£å†³</a></p>
<h4 id="2è¿è¡Œæ—¶å‡ºç°no-spring-session-store-is-configured">(2ï¼‰è¿è¡Œæ—¶å‡ºç°No Spring Session store is configured</h4>
<p>å¯ä»¥ç‚¹å‡»æŸ¥çœ‹<a href="https://blog.csdn.net/qq_37338761/article/details/100126831">No Spring Session store is configuredæŠ¥é”™è§£å†³</a></p>

          </div>
        </div>

        
          <div class="next-post">
            <a class="purple-link" href="https://wqyuu.github.io/blog/post/jian-dan-tu-jie-cong-ling-da-jian-springboot">
              <h3 class="post-title">
                ä¸‹ä¸€ç¯‡ï¼šç®€å•å›¾è§£ä»é›¶æ­å»ºSpringBoot
              </h3>
            </a>
          </div>
          
      </div>

      
        
          <div id="gitalk-container"></div>
        

        
      

      <div class="site-footer">
  <div class="slogan">ç§‰å¿ è´ä¹‹å¿—,å®ˆè°¦é€€ä¹‹èŠ‚</div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
  Powered by <a href="https://github.com/wqyuu" target="_blank">Wqyuu</a> | <a class="rss" href="https://wqyuu.github.io/blog/atom.xml" target="_blank">RSS</a>
</div>


    </div>
    <script type="application/javascript">

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>



  
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>

      var gitalk = new Gitalk({
        clientID: 'ad662aee99e9d77de1aa',
        clientSecret: 'b74b253f75d653647fccdfe37d7d554405fc6ddc',
        repo: 'blog',
        owner: 'wqyuu',
        admin: ['wqyuu'],
        id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
      })

      gitalk.render('gitalk-container')

    </script>
  

  




  </body>
</html>
